#                             -*- compilation -*-
143. truncate.at:29: testing truncate ...
./truncate.at:32:
mkdir v7
(cd v7
TEST_TAR_FORMAT=v7
export TEST_TAR_FORMAT
TAR_OPTIONS="-H v7"
export TAR_OPTIONS
rm -rf *

genfile --file foo --length 200k
genfile --file baz
genfile --run --checkpoint 10 --length 195k --truncate foo -- tar --checkpoint --checkpoint-action=echo --checkpoint-action=sleep=1 -vcf bar foo baz
echo Exit status: $?
echo separator
genfile --file foo --seek 195k --length 5k --pattern=zeros
tar dvf bar)
--- -	2015-11-24 15:39:30.773887238 +0800
+++ /root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/143/stderr	2015-11-24 15:39:30.770163828 +0800
@@ -1,2 +1,7 @@
-tar: foo: File shrank by 5120 bytes; padding with zeros
+/root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/143/test-source: line 40: genfile: command not found
+/root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/143/test-source: line 41: genfile: command not found
+/root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/143/test-source: line 42: genfile: command not found
+/root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/143/test-source: line 45: genfile: command not found
+tar: bar: Cannot open: No such file or directory
+tar: Error is not recoverable: exiting now
 
--- -	2015-11-24 15:39:30.775719727 +0800
+++ /root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/143/stdout	2015-11-24 15:39:30.770163828 +0800
@@ -1,8 +1,3 @@
-foo
-baz
-Exit status: 1
+Exit status: 127
 separator
-foo
-foo: Mod time differs
-baz
 
./truncate.at:32: exit code was 2, expected 1
143. truncate.at:29: 143. truncate (truncate.at:29): expected failure (truncate.at:32)
