#                             -*- compilation -*-
108. link03.at:24: testing working -l with --remove-files ...
./link03.at:34:
mkdir v7
(cd v7
TEST_TAR_FORMAT=v7
export TEST_TAR_FORMAT
TAR_OPTIONS="-H v7"
export TAR_OPTIONS
rm -rf *


genfile -l 64 -f file1
ln file1 file2
ln file2 file3
ln file3 file4

echo archive.1
tar -c -f archive.1 -l --remove-files file1 file2 file3 file4

genfile -l 64 -f file1
ln file1 file2
ln file2 file3
ln file3 file4

echo archive.2
tar -c -f archive.2 -l --remove-files file1 file2 file3
echo testing archive.2
tar tfv archive.2 | sed -n 's/.*file[2-3] link to //p'
)
--- -	2015-11-24 15:39:20.615468693 +0800
+++ /root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/108/stderr	2015-11-24 15:39:20.610164180 +0800
@@ -1,2 +1,18 @@
-tar: Missing links to 'file1'.
+/root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/108/test-source: line 55: genfile: command not found
+ln: accessing 'file1': No such file or directory
+ln: accessing 'file2': No such file or directory
+ln: accessing 'file3': No such file or directory
+tar: file1: Cannot stat: No such file or directory
+tar: file2: Cannot stat: No such file or directory
+tar: file3: Cannot stat: No such file or directory
+tar: file4: Cannot stat: No such file or directory
+tar: Exiting with failure status due to previous errors
+/root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/108/test-source: line 63: genfile: command not found
+ln: accessing 'file1': No such file or directory
+ln: accessing 'file2': No such file or directory
+ln: accessing 'file3': No such file or directory
+tar: file1: Cannot stat: No such file or directory
+tar: file2: Cannot stat: No such file or directory
+tar: file3: Cannot stat: No such file or directory
+tar: Exiting with failure status due to previous errors
 
--- -	2015-11-24 15:39:20.617404101 +0800
+++ /root/Desktop/tar-1.28/tests/testsuite.dir/at-groups/108/stdout	2015-11-24 15:39:20.610164180 +0800
@@ -1,6 +1,4 @@
 archive.1
 archive.2
 testing archive.2
-file1
-file1
 
108. link03.at:24: 108. working -l with --remove-files (link03.at:24): expected failure (link03.at:34)
